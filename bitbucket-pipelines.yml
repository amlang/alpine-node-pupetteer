image: atlassian/default-image:2
pipelines:
  default:
    - step:
        services:
          - docker
        script:
          - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
          - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
          - sudo apt-get update && sudo apt-get install yarn
          - export IMAGE_NAME=ivyowl/alpine-node-pupetteer
          - yarn build:all
          - docker login --username $DOCKER_HUB_USERNAME --password $DOCKER_HUB_PASSWORD
          - docker push $IMAGE_NAME
